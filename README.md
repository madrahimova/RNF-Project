# RNF-Project
Интерактивная база анкет пореволюционных эмигрантов

### Назначение
Проект носит исследовательский характер, результаты проекта (база данных и веб-приложение) предназначены для некоммерческого использования

Целью проекта является проведение обработки массива анкет Пражского комитета по ознаменованию 175-летия Московского университета, включая
* пакетную загрузку в базу данных о выпускниках ВУЗов и их судьбе в эмиграции после революции 1917 г.
* разработку моделей, позволяющих провести корреляционное и многофакторное исследование зафиксированных параметров анкет
* определение степени влияния факторов на жизненные и научные судьбы эмигрантов с высшим образованием
* создание типологии жизненных и научных судеб эмигрантов
* реконструкцию типичных судеб для представления их в виде исторических нарративов
 

## Пользователям
### Возможности
<table>
<tr><th>Возможность</th><th>Статус</th></tr>
<tr><td>Просмотр базы</td><td>Доступно</td></tr>
<tr><td>Поиск по базе</td><td>В разработке</td></tr>
<tr><td>Отчет по одной анкете</td><td>Доступно:<ol style="margin: 0;"><li>Н/С/В тип карьеры</li></ol></td></tr>
<tr><td>Отчет по всем анкетам</td><td>Доступно:
    <ol style="margin: 0;">
        <li>Диаграмма «Статистика по мужчинам и женщинам»</li>
        <li>Диаграмма «Статистика по молодым выпускникам»</li>
        <li>Диаграмма «Статистика по выпускам 1863-1884 и 1914-1918 гг.»</li>
        <li>Диаграмма «Статистика по ВУЗам»</li>
        <li>Диаграмма «Статистика по факультетам»</li>
        <li>Диаграмма «Статистика по городам»</li>
    </ol>
</td></tr>
</table>

### Документация
<b>ВНИМАНИЕ</b>

Используйте `ваш адрес` вместо `localhost`

<table>
<tr><th>Интерфейс</th><th>Локация</th></tr>
<tr><td>Swagger</td><td><a href="http://localhost:8000/docs">http://localhost:8000/docs</a></td></tr>
<tr><td>ReDoc</td><td><a href="http://localhost:8000/redoc">http://localhost:8000/redoc</a></td></tr>
</table>


## Разработчикам
### Разработка
Репозиторий содержит
* readme (текущий документ) с основными положениями проекта
* исходный код сервера веб-приложения с возможностью выполнять запросы через API (см. Пользователям → Документация)
* скрипты для запуска веб-приложения непосредственно на локальной машине и в контейнеризируемой среде ([Docker](https://www.docker.com/))

Репозиторий <b>не</b> содержит
* исходный код клиента
* API для возможностей в разработке (см. Пользователям → Возможности)
* автотесты
* отчеты об ошибках, уязвимостях и производительности

<i>Тесты и баг-репорты рекомендуется интегрировать в будущих обновлениях</i>

### Структура проекта
```
├── Dockerfile для запуска
├── Dockerfile.build для сборки
├── README.md
├── app
│   ├── core
│   │   ├── core.py ядро с логикой API 
│   │   └── data
│   │       ├── dataset.xlsx данные анкет
│   │       ├── names.jsonl данные имен
│   │       └── worldcities.xlsx данные городов
│   ├── main.py API
│   ├── models
│   │   └── models.py структуры данных
│   ├── packaging
│   │   ├── build.sh сборка пакета
│   │   ├── changelog_gen.sh генерация журнала изменений
│   │   ├── changelog_tmpl шаблон журнала изменений
│   │   ├── rnf-backend
│   │   │   ├── Makefile
│   │   │   └── debian
│   │   │       ├── changelog журнал изменений
│   │   │       ├── compat уровень совместимости
│   │   │       ├── control данные пакета
│   │   │       ├── rnf-backend.postinst скрипт после установки
│   │   │       ├── rnf-backend.preinst скрипт до установки
│   │   │       └── rules логика сборки
│   ├── requirements.txt зависимости приложения
│   ├── scripts
│   │   └── db_bootstrap.sh создание базы данных
│   └── systemd
│       └── rnf.service настройки сервиса systemd
├── run.sh локальный запуск
└── run_docker.sh запуск в Docker
```

### Тестирование и отладка
Предусмотрено два сценария
1. `run.sh` запустит сервер непосредственно на локальной машине
2. `run_docker.sh` создаст два контейнера: для сборки и для запуска
   * на этапе сборки в первом контейнере создается deb-пакет
   * на этапе запуска пакет копируется во второй контейнер и устанавливается в его среде
   * для повышения отказоустойчивости сервера запускается сервис systemd

<i>При использовании первого сценария отказоустойчивость не гарантирована, т. к. сервер не управляется внешними системами и не может возобновлять работу в случае прерывания</i>

Для второго сценария доступны опциональные параметры
* `-v` версия для установочного пакета
* `-t` метка журнала для управления детализацией вывода

### Ограничения
* Сборка установочного пакета и запуск возможны только в дистрибутивах [Debian](https://www.debian.org/index.ru.html)
* Сборка и запуск в других Unix-подобных системах возможна с помощью контейнеризируемой среды (см. Разработка)

<i>Локальный запуск `run.sh` позволяет обойти ограничения, но не рекомендован конечным пользователям, т. к. для этого требуются дополнительные зависимости</i>

<b>Неправильная установка зависимостей может привести к некорректной работе веб-приложения</b></i>

Для автоматизированной установки и эксплуатации ПО используйте установочный пакет в соответствии с ограничениями или контейнеризируемую среду `run_docker.sh`

Используйте локальный запуск только в целях отладки и тестирования

<hr/>

Исследование выполнено в Петрозаводском государственном университете (ПетрГУ) за счет гранта Российского научного фонда № 23-28-00836, https://rscf.ru/project/23-28-00836
